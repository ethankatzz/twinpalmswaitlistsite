<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twin Palms - New York</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel for JSX compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Process Polyfill for Framer Motion -->
    <script>
        window.process = { env: { NODE_ENV: 'production' } };
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Smooth scrolling */
        html { scroll-behavior: smooth; }
    </style>
</head>
<body class="bg-[#F2F0E9] overflow-hidden">
    <div id="root"></div>

    <!-- Import Map -->
    <!-- Updated to use explicit externalization for dependencies to prevent React version conflicts -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.3.1",
            "react-dom/client": "https://esm.sh/react-dom@18.3.1/client",
            "framer-motion": "https://esm.sh/framer-motion@10.16.4?external=react,react-dom"
        }
    }
    </script>

    <!-- Application Code -->
    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import { createRoot } from 'react-dom/client';
        import { motion, AnimatePresence, useMotionValue, useTransform, useSpring } from 'framer-motion';

        // --- Icons (Inline for portability) ---
        
        const ArrowRight = ({ size = 24, strokeWidth = 2, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M5 12h14" />
                <path d="m12 5 7 7-7 7" />
            </svg>
        );

        const Check = ({ size = 24, strokeWidth = 2, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M20 6 9 17l-5-5" />
            </svg>
        );

        const Plus = ({ size = 24, strokeWidth = 2, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth={strokeWidth} strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M5 12h14" />
                <path d="M12 5v14" />
            </svg>
        );

        // --- Components ---

        /**
         * GrainOverlay
         * Adds a subtle texture. Adapted for the lighter cream background.
         */
        const GrainOverlay = () => (
            <div className="fixed inset-0 pointer-events-none opacity-[0.08] mix-blend-multiply z-40">
                <svg className='w-full h-full'>
                    <filter id='noiseFilter'>
                        <feTurbulence 
                            type='fractalNoise' 
                            baseFrequency='0.85' 
                            numOctaves='3' 
                            stitchTiles='stitch'/>
                    </filter>
                    <rect width='100%' height='100%' filter='url(#noiseFilter)'/>
                </svg>
            </div>
        );

        /**
         * SkylineAssemblage
         * A generative set of lines that draw up to form the Hudson Yards silhouette.
         */
        const SkylineAssemblage = ({ mouseX, mouseY }) => {
            // Parallax physics - Smooth and weighty
            const moveX = useSpring(useTransform(mouseX, [0, window.innerWidth], [-20, 20]), { stiffness: 30, damping: 30 });
            const moveY = useSpring(useTransform(mouseY, [0, window.innerHeight], [-10, 10]), { stiffness: 30, damping: 30 });
            const skew = useSpring(useTransform(mouseX, [0, window.innerWidth], [-1, 1]), { stiffness: 20, damping: 30 });

            // 45 lines to create the resolution of the skyline
            const lines = Array.from({ length: 45 });

            return (
                <motion.div 
                    style={{ x: moveX, y: moveY, skewX: skew }}
                    className="absolute bottom-0 left-0 right-0 h-[85vh] pointer-events-none z-0 flex justify-center items-end overflow-hidden"
                >
                    <svg viewBox="0 0 100 60" className="w-full h-full md:w-[80%] max-w-[1200px]" preserveAspectRatio="none">
                        {lines.map((_, i) => {
                            const x = (i / lines.length) * 100;
                            
                            // --- Skyline Silhouette Logic ---
                            let height = 10; // base height
                            
                            // The Vessel / Shops (Left side low rise)
                            if (x < 20) {
                                height = 15 + Math.sin(x) * 5;
                            } 
                            // 10 Hudson Yards (Angled top)
                            else if (x >= 20 && x < 40) {
                                height = 30 + (x - 20) * 1.5; 
                            }
                            // The Gap
                            else if (x >= 40 && x < 45) {
                                height = 20;
                            }
                            // 30 Hudson Yards (The Peak)
                            else if (x >= 45 && x < 75) {
                                // Creating the iconic triangle peak
                                if (x < 60) height = 50 + (x - 45) * 2; // Rising edge
                                else height = 80 - (x - 60) * 3;        // Sharp falling edge (the balcony)
                            }
                            // 55 Hudson Yards / Others
                            else {
                                height = 35 - (x - 75) * 0.5;
                            }

                            // Randomize slightly for "sketch" feel
                            height += Math.random() * 2;

                            return (
                                <motion.line
                                    key={i}
                                    x1={x + "%"}
                                    y1="100%"
                                    x2={x + "%"}
                                    y2={100 - height + "%"}
                                    initial={{ pathLength: 0, opacity: 0 }}
                                    animate={{ 
                                        pathLength: 1, 
                                        opacity: [0, 0.4, 0.8], // Flicker in slightly
                                    }}
                                    transition={{
                                        duration: 2.5,
                                        delay: i * 0.05 + 0.5, // Staggered draw from left to right
                                        ease: "easeInOut"
                                    }}
                                    stroke="url(#skylineGradient)"
                                    strokeWidth="0.3"
                                    strokeLinecap="square"
                                />
                            );
                        })}
                        <defs>
                            <linearGradient id="skylineGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" stopColor="#292524" stopOpacity="0.8" /> {/* Dark Charcoal top */}
                                <stop offset="60%" stopColor="#78716c" stopOpacity="0.4" /> {/* Warm Grey middle */}
                                <stop offset="100%" stopColor="#F2F0E9" stopOpacity="0" />   {/* Fade to cream bottom */}
                            </linearGradient>
                        </defs>
                    </svg>
                </motion.div>
            );
        };

        /**
         * Rotating3DLogo
         * A high-fidelity, nested mechanical structure.
         * Features 3 Layers:
         * 1. Outer Exoskeleton (Glass + Cross-Bracing)
         * 2. Middle Gyro Mechanism (Counter-Rotating Cage)
         * 3. Hyper-Core (Solid Block with Connecting Rods)
         */
        const Rotating3DLogo = () => {
            const size = 180; // Main container
            const halfSize = size / 2;
            const midSize = 100; // Middle layer
            const midHalf = midSize / 2;
            const innerSize = 40; // Core
            const innerHalf = innerSize / 2;
            
            return (
                <div className="w-[180px] h-[180px] mx-auto mb-20 [perspective:1200px] z-20 relative">
                    {/* Main Container - Rotates X (Tumble) & Slight Y tilt */}
                    <motion.div
                        className="w-full h-full relative [transform-style:preserve-3d]"
                        style={{ rotateY: 30 }}
                        animate={{ rotateX: -360 }}
                        transition={{ duration: 20, ease: "linear", repeat: Infinity }}
                    >
                         {/* --- LAYER 1: Outer Structural Exoskeleton --- */}
                         {[
                            { rotate: 'rotateY(0deg)', translate: `translateZ(${halfSize}px)` },
                            { rotate: 'rotateY(180deg)', translate: `translateZ(${halfSize}px)` },
                            { rotate: 'rotateX(90deg)', translate: `translateZ(${halfSize}px)` },
                            { rotate: 'rotateX(-90deg)', translate: `translateZ(${halfSize}px)` },
                            { rotate: 'rotateY(90deg)', translate: `translateZ(${halfSize}px)` },
                            { rotate: 'rotateY(-90deg)', translate: `translateZ(${halfSize}px)` },
                        ].map((face, i) => (
                            <div key={`outer-${i}`} className="absolute inset-0 border border-[#292524]/20 bg-[#F2F0E9]/5" 
                                 style={{ transform: `${face.rotate} ${face.translate}` }}>
                                 
                                 {/* Structural Cross-Bracing (Sharp Lines) */}
                                 <div className="absolute inset-0 bg-[linear-gradient(45deg,transparent_49%,rgba(41,37,36,0.15)_50%,transparent_51%)]" />
                                 <div className="absolute inset-0 bg-[linear-gradient(-45deg,transparent_49%,rgba(41,37,36,0.15)_50%,transparent_51%)]" />
                                 
                                 {/* Heavy Corner Brackets */}
                                 <div className="absolute top-0 left-0 w-6 h-6 border-t-2 border-l-2 border-[#292524]" />
                                 <div className="absolute bottom-0 right-0 w-6 h-6 border-b-2 border-r-2 border-[#292524]" />
                                 <div className="absolute top-0 right-0 w-2 h-2 border-t border-r border-[#292524]/50" />
                                 <div className="absolute bottom-0 left-0 w-2 h-2 border-b border-l border-[#292524]/50" />
                            </div>
                        ))}

                        {/* --- LAYER 2: Middle Gyro Mechanism (Counter Rotation) --- */}
                        <div className="absolute top-1/2 left-1/2 w-[100px] h-[100px] -ml-[50px] -mt-[50px] [transform-style:preserve-3d]">
                             <motion.div
                                className="w-full h-full relative [transform-style:preserve-3d]"
                                animate={{ rotateY: 360, rotateZ: -360 }}
                                transition={{ duration: 15, ease: "linear", repeat: Infinity }}
                             >
                                {/* Wireframe Cage */}
                                {[
                                    { rotate: 'rotateY(0deg)', translate: `translateZ(${midHalf}px)` },
                                    { rotate: 'rotateY(180deg)', translate: `translateZ(${midHalf}px)` },
                                    { rotate: 'rotateX(90deg)', translate: `translateZ(${midHalf}px)` },
                                    { rotate: 'rotateX(-90deg)', translate: `translateZ(${midHalf}px)` },
                                    { rotate: 'rotateY(90deg)', translate: `translateZ(${midHalf}px)` },
                                    { rotate: 'rotateY(-90deg)', translate: `translateZ(${midHalf}px)` },
                                ].map((face, i) => (
                                    <div key={`mid-${i}`} className="absolute inset-0 border border-[#292524]/40" 
                                         style={{ transform: `${face.rotate} ${face.translate}` }}>
                                         {/* Mid-layer details: Connecting notches */}
                                         <div className="absolute top-1/2 left-0 w-2 h-2 bg-[#292524] -translate-x-1/2 -translate-y-1/2" />
                                         <div className="absolute top-1/2 right-0 w-2 h-2 bg-[#292524] translate-x-1/2 -translate-y-1/2" />
                                         <div className="absolute left-1/2 top-0 w-2 h-2 bg-[#292524] -translate-x-1/2 -translate-y-1/2" />
                                         <div className="absolute left-1/2 bottom-0 w-2 h-2 bg-[#292524] -translate-x-1/2 translate-y-1/2" />
                                    </div>
                                ))}
                             </motion.div>
                        </div>

                        {/* --- LAYER 3: Inner Core (Solid & Complex with Rods) --- */}
                        <div className="absolute top-1/2 left-1/2 w-[40px] h-[40px] -ml-[20px] -mt-[20px] [transform-style:preserve-3d]">
                            <motion.div
                                className="w-full h-full relative [transform-style:preserve-3d]"
                                animate={{ rotateX: 360, rotateY: 360 }}
                                transition={{ duration: 5, ease: "linear", repeat: Infinity }}
                            >
                                {/* Solid Core Blocks */}
                                {[
                                    { rotate: 'rotateY(0deg)', translate: `translateZ(${innerHalf}px)` },
                                    { rotate: 'rotateY(180deg)', translate: `translateZ(${innerHalf}px)` },
                                    { rotate: 'rotateX(90deg)', translate: `translateZ(${innerHalf}px)` },
                                    { rotate: 'rotateX(-90deg)', translate: `translateZ(${innerHalf}px)` },
                                    { rotate: 'rotateY(90deg)', translate: `translateZ(${innerHalf}px)` },
                                    { rotate: 'rotateY(-90deg)', translate: `translateZ(${innerHalf}px)` },
                                ].map((face, i) => (
                                    <div key={`inner-${i}`} className="absolute inset-0 bg-[#292524] border border-[#78716c]" 
                                         style={{ transform: `${face.rotate} ${face.translate}` }}>
                                         {/* Core detail: Inner light */}
                                         <div className="absolute inset-2 border border-[#F2F0E9]/30" />
                                    </div>
                                ))}
                                
                                {/* "Connecting Shit" - Rods extending from Core */}
                                {/* Y-Axis Rod */}
                                <div className="absolute top-1/2 left-1/2 h-[140px] w-[2px] bg-[#292524] -translate-x-1/2 -translate-y-1/2" 
                                     style={{ transform: 'translate(-50%, -50%)' }} />
                                {/* X-Axis Rod */}
                                <div className="absolute top-1/2 left-1/2 w-[140px] h-[2px] bg-[#292524] -translate-x-1/2 -translate-y-1/2" 
                                     style={{ transform: 'translate(-50%, -50%)' }} />
                                {/* Z-Axis Rod (Simulated via rotation) */}
                                <div className="absolute top-1/2 left-1/2 w-[140px] h-[2px] bg-[#292524] -translate-x-1/2 -translate-y-1/2" 
                                     style={{ transform: 'translate(-50%, -50%) rotateY(90deg)' }} />

                            </motion.div>
                        </div>
                    </motion.div>
                </div>
            );
        };

        /**
         * Main Application Component
         */
        const App = () => {
            const [email, setEmail] = useState('');
            const [viewState, setViewState] = useState('intro'); // 'intro' | 'form' | 'success'
            const [isLoading, setIsLoading] = useState(false);
            
            const mouseX = useMotionValue(0);
            const mouseY = useMotionValue(0);

            const handleMouseMove = (e) => {
                mouseX.set(e.clientX);
                mouseY.set(e.clientY);
            };

            const handleJoinClick = () => {
                setViewState('form');
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!email) return;
                setIsLoading(true);
                setTimeout(() => {
                    setIsLoading(false);
                    setViewState('success');
                    setEmail('');
                }, 1500);
            };

            return (
                <div 
                    className="relative w-full h-screen bg-[#F2F0E9] text-[#292524] overflow-hidden font-sans selection:bg-[#292524] selection:text-[#F2F0E9]"
                    onMouseMove={handleMouseMove}
                >
                    <GrainOverlay />
                    
                    {/* --- Ambient Background Vignette (Inverted for Light Mode) --- */}
                    <div className="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#e6e4dc] z-0 pointer-events-none" />
                    
                    {/* --- The Skyline Art --- */}
                    <SkylineAssemblage mouseX={mouseX} mouseY={mouseY} />

                    {/* --- Main Content --- */}
                    <div className="relative z-10 w-full h-full flex flex-col items-center justify-center px-6 pt-10">
                        
                        {/* Header area - Simplified */}
                        <motion.div
                            initial={{ opacity: 0, scale: 0.9 }}
                            animate={{ opacity: 1, scale: 1 }}
                            transition={{ duration: 1.5, ease: "easeOut" }}
                            className="text-center w-full max-w-2xl"
                        >
                            {/* 3D Rotating Logo - Central Focal Point */}
                            <Rotating3DLogo />

                            <motion.p 
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 0.6 }}
                                transition={{ delay: 1.2, duration: 1 }}
                                className="text-xs md:text-sm tracking-[0.3em] uppercase text-[#57534e] font-medium mb-12"
                            >
                            &middot; Capsule One
                               &middot; Coming Soon &middot;
                            </motion.p>
                        </motion.div>

                        {/* Interaction Area */}
                        <div className="w-full max-w-md relative h-32 flex items-start justify-center">
                            <AnimatePresence mode='wait'>
                                
                                {/* 1. Initial Button View */}
                                {viewState === 'intro' && (
                                    <motion.button
                                        key="intro-btn"
                                        initial={{ opacity: 0, y: 20 }}
                                        animate={{ opacity: 1, y: 0 }}
                                        exit={{ opacity: 0, y: 10, filter: "blur(5px)" }}
                                        whileHover={{ scale: 1.02 }}
                                        whileTap={{ scale: 0.98 }}
                                        onClick={handleJoinClick}
                                        className="group relative px-12 py-5 bg-[#292524] text-[#F2F0E9] uppercase tracking-[0.2em] text-xs transition-all duration-500 shadow-xl shadow-[#292524]/10 hover:shadow-[#292524]/20"
                                    >
                                        <span className="relative z-10 flex items-center gap-4">
                                            Join the Waitlist <Plus size={12} className="text-[#F2F0E9]/60 group-hover:text-[#F2F0E9] transition-colors" />
                                        </span>
                                    </motion.button>
                                )}

                                {/* 2. Form View */}
                                {viewState === 'form' && (
                                    <motion.form
                                        key="form"
                                        initial={{ opacity: 0, width: "60%" }}
                                        animate={{ opacity: 1, width: "100%" }}
                                        exit={{ opacity: 0, scale: 0.95, filter: "blur(5px)" }}
                                        transition={{ duration: 0.6, ease: [0.22, 1, 0.36, 1] }}
                                        onSubmit={handleSubmit}
                                        className="flex flex-col group relative w-full"
                                    >
                                        <div className="relative flex items-center">
                                            <motion.input
                                                autoFocus
                                                type="email"
                                                required
                                                placeholder="E-mail Address"
                                                value={email}
                                                onChange={(e) => setEmail(e.target.value)}
                                                disabled={isLoading}
                                                className="w-full bg-transparent border-b border-[#a8a29e] py-4 text-center text-xl font-light tracking-wide text-[#292524] placeholder-[#a8a29e]/70 focus:outline-none focus:border-[#292524] transition-all duration-500 disabled:opacity-50 rounded-none"
                                            />
                                            
                                            <motion.button
                                                initial={{ opacity: 0, x: -10 }}
                                                animate={{ opacity: 1, x: 0 }}
                                                transition={{ delay: 0.2 }}
                                                whileHover={{ scale: 1.1, x: 5 }}
                                                whileTap={{ scale: 0.95 }}
                                                type="submit"
                                                disabled={isLoading || !email}
                                                className="absolute right-0 p-2 text-[#78716c] hover:text-[#292524] disabled:opacity-0 transition-all duration-300"
                                            >
                                                {isLoading ? (
                                                    <motion.div 
                                                        animate={{ rotate: 360 }}
                                                        transition={{ duration: 1, repeat: Infinity, ease: "linear" }}
                                                        className="w-5 h-5 border-t border-[#292524] rounded-full" 
                                                    />
                                                ) : (
                                                    <ArrowRight size={24} strokeWidth={1} />
                                                )}
                                            </motion.button>
                                        </div>
                                    </motion.form>
                                )}

                                {/* 3. Success View */}
                                {viewState === 'success' && (
                                    <motion.div
                                        key="success"
                                        initial={{ opacity: 0, scale: 0.95 }}
                                        animate={{ opacity: 1, scale: 1 }}
                                        exit={{ opacity: 0 }}
                                        className="text-center w-full"
                                    >
                                        <div className="flex flex-col items-center gap-3">
                                            <Check size={24} className="text-[#292524]" strokeWidth={1} />
                                            <span className="text-sm tracking-[0.2em] text-[#292524] uppercase border-b border-[#292524] pb-1">Registered</span>
                                            <p className="text-[#78716c] text-[10px] tracking-widest mt-2">We'll Notify You When You're Off The Waitlist.</p>
                                        </div>
                                    </motion.div>
                                )}
                            </AnimatePresence>
                        </div>
                    </div>

                    {/* --- Footer --- */}
                    <motion.footer 
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1 }}
                        transition={{ delay: 2, duration: 1 }}
                        className="absolute bottom-10 w-full flex justify-between px-8 md:px-12 text-[10px] tracking-[0.2em] uppercase text-[#78716c] z-10 font-semibold mix-blend-multiply"
                    >
                        <span>TWIN PALMS</span>
                        <span className="hidden md:inline">West Village, NYC</span>
                        <span>Est. 2016</span>
                    </motion.footer>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>